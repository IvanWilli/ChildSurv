---
title: "Child survival for mothers: mortality change and related measures"
author: "Ivan Williams and Diego Alburez-Gutierrez"
date: "07 August 2019"
output: pdf_document
bibliography: bib.bibtex
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>")
```

## Abstract

### Background

The expected number of descendants for mothers is an important relation in kinship theory. Child survival (and child death) affect mothers in a variety of ways, yet it is not clear how changes in mortality schedules, given a fertility pattern, affect the number of surviving children from the standpoint of mothers. 

### Objective

Existing formal demographic tools are used within a stable population framework to characterize child survival from the point of view of a mother, considering both absolute and relative changes in mortality patterns.

### Results

The expected change in child survival given an absolute change in mortality depends on the difference between the age of a mother and the age structure of her surviving children. The effects of relative changes in mortality are explained using a fertility-weighted measure of entropy.

### Contribution

The paper proposes new expresions and measures to characterize the effects of changes in mortality on child survival. These can be applied to populations at different stages of the demographic transition. 


## 1. Relationship

$CS_a$ is the expected number of surviving children to a woman aged $a$ in a stable female population with fertility rates $m_{x}$ and force of mortality $\mu_{x}$, as proposed by @goodman1974:

\begin{equation}
\label{eq:CS}
CS_a = \int_{\alpha}^a{m_{x}l_{a-x}dx}.
\end{equation}

We now consider the consequences of a change $\delta$ in mortality in the range $[0,a-\alpha]$, where $\alpha$ is the start age of fertility risk. A discrete approximate of the effect on $CS_a$ given an absolute change in mortality $m_{x,\delta}=m_{x}+\delta$ is (@wrycza2012):

\begin{equation}
\label{eq:abs_change}
\frac{\Delta CS_{a}}{CS_{a}} \approx -(a - \overline{x}_{(CS)}) \Delta\delta.
\end{equation}

In this equation, the expected change in child survival is inversely proportional to the difference between maternal age \textit{a} and the mean age of the mother at the birth of her surviving daughters $\overline{x}_{(CS)}$. The magnitude of the change depends negatively on the age distribution of the surviving offspring. This is intuitive considering that younger children experience longer periods of exposure to risk.

The relationship is less clear for proportional changes in mortality $m_{x,\delta}=m_{x}(1+\delta)$ given the interaction of birth and mortality rates (@KeyfitzMath). Neverthless we can say that, in discrete terms:

\begin{equation}
\label{eq:relat_change}
\frac{\Delta CS_{a}}{CS_{a}} \approx -H_{CS_a} \Delta\delta.
\end{equation}

<!-- Aqui no cambie nada porque no entiendo muy bien lo que hiciste. Talvez hablamos para discutir? -->

Where $H_{CS_a}$ can be interpreted as a temporary entropy constant until age $a-\alpha$. The age structure of the surviving daughters $C_{CS_a}(x)=\frac{m_{x}l_{a-x}}{CS_{a}}$ determines the contribution of each age to the disparity measure $H_{CS_a}=\int_\alpha^a{C_{CS_a}(x)H(x)}$ (@Aburto2019). The effect of a relative change $\delta$ on $CS_{a}$ will be stronger in cases where the mortality is more disperse at ages where fertility is high. Consider the two fertility schedules depicted in Figure \ref{fig:relative_change}. Against the backdrop of a mortality hump in early adulthood (dashed line), we anticipate a more pronounced change in $C_{CS_a}$ for the younger fertility schedule.

```{r relative_change, echo=F, fig.align='center', warning=F, out.width = '70%', fig.cap="Two different fertility schedules (solid lines) and a big mortality hump (right axis, dashed line). The vertical lines show the mean age at birth for each schedule."}

# genero m_x (old and young pattern) y l_x (with big hump) 
f_young = data.frame(x=c(15,20,25,30,35,40), f=c(0,.3,.3,.05,.01,.01))
f_old = data.frame(  x=c(15,20,25,30,35,40), f=c(0,.04,.06,.25,.1,.01))
f_young_p = predict(loess(f~x, data = f_young), 15:40)
f_old_p = predict(loess(f~x, data = f_old), 15:40)
f_young_mean = sum(f_young_p*15:40/sum(f_young_p))
f_old_mean = sum(f_old_p*15:40/sum(f_old_p))
m_si_hump = data.frame(x= c(0,1,5,10,15,20,25), l=c(1,.98,.97,.97,.96,.9,.85))
m_si_hump_sp = splinefun(m_si_hump, method = "monoH.FC")

#graph
library(latex2exp)
par(mfrow=c(1,1),mar = c(5,5,2,5))
plot(15:40, f_young_p, t="l",xlab="x (mother age)", ylab= TeX(sprintf("$m_x$"))) 
lines(15:40, f_old_p, lty=1, col=2) 
abline(v=f_young_mean, lty=2, col="grey")
abline(v=f_old_mean, lty=2, col="grey")
par(new = T)
plot(0:25, rev(m_si_hump_sp(0:25)), axes=F, xlab=NA, ylab=NA, t="l", col=1, lty=2)
axis(side = 4)
mtext(side = 4, line = 3, TeX(sprintf("$l_{40-x}$")))

#calculate entropy CS
H_young = -sum(f_young_p*rev(m_si_hump_sp(0:25))*log(rev(m_si_hump_sp(0:25))))/
  sum(f_young_p*rev(m_si_hump_sp(0:25)))
H_old = -sum(f_old_p*rev(m_si_hump_sp(0:25))*log(rev(m_si_hump_sp(0:25))))/
  sum(f_old_p*rev(m_si_hump_sp(0:25)))
```

## 2. Proofs

### 2.1. Absolute change

Considering that $m_{x,\delta}=m_{x}+\delta$ (@wrycza2012), and $l_{a-x} = e^{-\int_{0}^{a-x}{(\mu_t+\delta})}$ :

\begin{equation}
CS_{(a)}^\delta = \int_{\alpha}^{a}m_{x} l_{a-x} e^{-\delta (a-x)} dx.  
\end{equation}

We get the derivative of $dCS_{(a)}^\delta / d\delta$ evaluated near zero (@KeyfitzMath) to find the effects of adding $\delta$ to the age-specific death rates of daughters:

\begin{equation}
\label{eq2}
= -a\int_{\alpha}^{a}m_{x} l_{a-x} dx + \int_{\alpha}^{a}m_{x} l_{a-x}x dx.
\end{equation}

Since $CS_{a} = \int_{\alpha}^{a}m_{x} l_{a-x} dx$, we can rewrite equation (\ref{eq2}) as

\begin{equation}
\frac{dCS^\delta}{d\delta} = -a CS_{a}  + \int_{\alpha}^{a} x m_{x} l_{a-x} dx.
\end{equation}

Dividing both sides by $CS_{a}$ and multiplying by $d\delta$, we get

\begin{equation}
\label{mort_cont}
\frac{d CS_{a}}{CS_{a}} = -(a - \overline{x}_{(CS)}) d\delta
\end{equation}

where $\overline{x}_{(CS)}$ is the mean age of women at the birth of their surviving daughters in a stationary population. 


### 2.2. Relative change

Considering that $m_{x,\delta}=m_{x}(1+\delta)$ and $l_{a-x,\delta} = e^{-\int_{0}^{a-x}{\mu_t(1+\delta})dt}=l_{a-x}^{(1+\delta)}$:

\begin{equation}
CS_{a}^\delta = \int_{\alpha}^{a} {m_{x} l_{a-x}^{(1+\delta)}} dx.  
\end{equation}

Using the derivative of $dCS_{(a)}^\delta / d\delta = log(l_{a-x}) l_{a-x}^{(1+\delta)}$ and evaluating $\delta$ near zero we get the final expression:

\begin{equation}
\label{mort_change_relative}
\frac{d CS_{a}}{CS_{a}} = \frac{ \int_{\alpha}^{a}m_{x} l_{a-x} \log(l_{a-x}) dx}{CS_{a}} d\delta.
\end{equation}

We now define the information function $H_{CS_a}=\int_\alpha^a{C_{CS_a}H(x)}$ in analogy to the classic entropy function $H$ (@KeyfitzMath, @Aburto2019). Whereas the weights in the latter are given by the survival function, in Equation \ref{eq:relat_change2} they come from the onset distribution of surviving daughters $C_{CS_a}(x)=\frac{m_{x}l_{a-x}}{CS_{a}}$, so that:

\begin{equation}
\label{eq:relat_change2}
\frac{dCS_{a}}{CS_{a}} = -H_{CS_a} d\delta.
\end{equation}

## 3. History

Kin count estimation has a long pedigree in mathematical demography. @lotka1931orphanhood proposed to model the orphanhood in a theorical population, comparing the effect across demographic regimes. Equation  \ref{eq:CS} was originally proposed by @brass_derivation_1953 to estimate child mortality. The notion of estimating the expected number of living daughters in a stable population was generalized by @goodman1974 for other kin relations (granddaughters, cousins, etc.). The "counting method" approach, being the net reproduction rate $R_0$ limited to $a$, or the (not complete) ratio between generations (multiplying and dividing by the mother generation $B$), was further popularized by @KeyfitzMath. @bongaarts_projection_1987 used a similar approach to estimate descendants in his 'Family Status Model'. More recently, @wrycza2012 has looked at the formal effect of different kind of changes in mortality by age in a paper published in this series. 

## 4. Related meassures

This section proposes two additional measures related to the child survival measure for a mother aged $a$. 

### 4.1. Time with children lost

*Mean Time Spent with Lost* ($MTSL$) is an absolute measure of the expected total time with a death daughter that lives a mother, which can be expressed in terms of a temporary expected lost years measure $e^\dagger$: 

\begin{equation}
\label{eq:MTSL}
MTSL_a = \int_\alpha^a{m_x\int_0^{a-x}{d_t e_{0,a-x-t} dt}dx} = \int_\alpha^a{m_x e_{o,a-x}^\dagger dx}.
\end{equation}

Where $d_t$ is the death distribution from birth, and $e_{0,a-x-t}$ is the life expectancy at birth until age $a-x-t$.

It is useful to compare these lost years with the expected time that mother will live with their daughters. We call this the *intensity* of loss (*Intensity Time Lost* ($ITL$)): ratio between expected time with "lost"" and expected time with "life". This also makes possible to compare between fertility regimes:

\begin{equation}
\label{eq:ITL}
  ITL_a = \frac{\int_\alpha^a{m_x e_{o,a-x}^\dagger dx}}{\int_\alpha^a{m_x e_{o,a-x} dx}}
\end{equation}

### 4.2. Mean Age at Child Loss

Different populations could have different mean age at child loss ($MAL_a$) for mothers aged $a$ with at least a death child:

\begin{equation}
\label{eq:MAL}
  MAL_a = K_a + \int_\alpha^a{f_{x,a} MAD_{a-x}}
\end{equation}

Equation \ref{eq:MAL} can be derived by starting with the mother age $x+t$ at each death child age at death $t$, weighted by the fertility and survival function. In it, $K_a$ is the mean age at childbirth for womens aged $a$, $MAD_{a-x}$ refers to the mean age at death for newborns that die before $a-x$, $TFR_a$ is the cumulated fertility for a women aged $a$, and $f_{x,a}$ is the cumulative age distribution of fertility up to age $a$:

\begin{equation}
\label{eq:MALproof}
\begin{split}  
  MAL_a = \frac{\int_\alpha^a{m_x {\int_0^{a-x}\frac{d_t (x+t) dt}{\int_0^{a-x}{d_tdt}}}}}{\int_\alpha^a{m_x}} \\
  MAL_a = \frac{\int_\alpha^a{m_x x}}{TFR_a} + \frac{\int_\alpha^a{m_x MAD_{a-x}}}{TFR_a} \\
  MAL_a = K_a + \frac{\int_\alpha^a{m_x MAD_{a-x}}}{TFR_a}
\end{split}
\end{equation}

<!-- Arriving to the equation \ref{eq:MAL}. -->

## 5. Applications

<!-- Aquí tenemos dos opciones de aplicación  -->

* The proposed meassures are applied to two different demographic regimes.

[PENDING]

* A computation approach is used to evaluate the relative contribution of each component given a relative change in $\delta$.

[PENDING]

## 5. Bibliography